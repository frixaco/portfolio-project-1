(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[5],{145:function(e,t){},161:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=(a(96),a(25)),c=a(53),l=a(3),o=a(52),i=a(26);var u=function(e){var t=e.myposts;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{className:"text-center bg-light py-4"},"MY POSTS"),r.a.createElement("div",{className:"myposts-container"},0!==t.length&&t.map((function(e,t){return r.a.createElement("div",{key:t,className:"post"},r.a.createElement("div",{className:"left"},r.a.createElement("div",{className:"top"},r.a.createElement("div",{className:"userdata"},r.a.createElement("p",null,e.author),r.a.createElement("h4",null,e.title),r.a.createElement("span",null,e.date)),r.a.createElement("div",{className:"icon"},r.a.createElement(i.b,{to:"/".concat(e._id)},r.a.createElement("i",{className:"fas fa-eye"})))),r.a.createElement("div",{className:"bottom"},r.a.createElement("p",null,e.content))),r.a.createElement("img",{src:e.imglink,alt:""}))}))))},m=a(59),d=a.n(m),p=a(60),E=a(54),g=a.n(E),f=a(55);var v=Object(s.b)(null,{logoutUser:c.b})((function(e){var t=e.username,a=e.logoutUser,n=function(){var e=Object(p.a)(d.a.mark((function e(n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.post("/profile",{username:t});case 3:f.a.emit("user_disconnected",t),a(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("Error when deleting account");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("nav",{className:"profile-nav"},r.a.createElement(i.b,{to:"/"},r.a.createElement("div",{className:"icon"},r.a.createElement("i",{className:"fas fa-arrow-left"}))),r.a.createElement("button",{disabled:"GuestUser"===t,onClick:n,className:"icon"},r.a.createElement("i",{className:"fas fa-user-slash"})))}));var b=Object(s.b)((function(e){var t=e.user,a=t.username,n=t.email,r=e.posts,s=r.items,c=r.areFetching;return{myposts:s.filter((function(e){return e.author===a})),username:a,email:n,areFetching:c}}),{updateUserAsync:c.c})((function(e){var t=e.username,a=e.email,s=e.areFetching,c=e.myposts,l=e.updateUserAsync,i=Object(n.useState)(""),m=Object(o.a)(i,2),d=m[0],p=m[1],E=Object(n.useState)(""),g=Object(o.a)(E,2),f=g[0],b=g[1],h=Object(n.useState)(""),O=Object(o.a)(h,2),y=O[0],N=O[1];return r.a.createElement("main",{className:"profile-page-container"},r.a.createElement(v,{username:t}),r.a.createElement("div",{className:"profile-username"},r.a.createElement("h3",null,t)),"GuestUser"===t?r.a.createElement("div",{className:"alert"},"GuestUsers cannot edit profile details"):null,r.a.createElement("div",{className:"profile-details-card"},r.a.createElement("div",{className:"details-edit"},r.a.createElement("p",null,t),r.a.createElement("input",{value:d,onChange:function(e){return p(e.target.value)},disabled:"GuestUser"===t,type:"text"}),r.a.createElement("button",{onClick:function(){return l({key:"username",value:d})}},"Save")),r.a.createElement("div",{className:"detail"},r.a.createElement("p",null,"Username"))),r.a.createElement("div",{className:"profile-details-card"},r.a.createElement("div",{className:"details-edit"},r.a.createElement("p",null,a),r.a.createElement("input",{value:f,onChange:function(e){return b(e.target.value)},disabled:"GuestUser"===t,type:"email"}),r.a.createElement("button",{onClick:function(){return l({key:"email",value:f})}},"Save")),r.a.createElement("div",{className:"detail"},r.a.createElement("p",null,"Email"))),r.a.createElement("div",{className:"profile-details-card"},r.a.createElement("div",{className:"details-edit"},r.a.createElement("input",{value:y,onChange:function(e){return N(e.target.value)},disabled:"GuestUser"===t,type:"password"}),r.a.createElement("button",{onClick:function(){return l({key:"password",value:y})}},"Save")),r.a.createElement("div",{className:"detail"},r.a.createElement("p",null,"Password"))),r.a.createElement(u,{loading:s,myposts:c}))})),h=a(27),O=a(1),y=a(95),N=(a(90),RegExp(/^(([^<>()\]\\.,;:\s@"]+(\.[^<>()\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)),C=function(e){var t=!0;return Object.values(e).forEach((function(e){return e.length>0&&(t=!1)})),t};var S=Object(s.b)((function(e){var t=e.user;return{loading:t.loading,guest:t.guest}}),{loginUserAsync:c.a})((function(e){var t=e.loading,a=e.loginUserAsync,s=e.guest,c=Object(n.useState)({username:"",password:"",errors:{username:"",password:""}}),l=Object(o.a)(c,2),i=l[0],u=l[1],m=function(e){var t=e.target,a=t.name,n=t.value;console.log(a,n);var r=i.errors;switch(a){case"username":r.username=n.length<5?"At least 5 characters!":"";break;case"password":r.password=n.length<6?"At least 6 characters!":""}u(Object(O.a)(Object(O.a)({},i),{},Object(h.a)({errors:r},a,n)))},d=function(e){!C(i.errors)||"Enter"!==e.key&&void 0!==e.key||(y.c.info("Logging in...",{position:"top-right",autoClose:1e3,hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,transition:y.a}),a(i),u({username:"",password:"",errors:{username:"",password:""}}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{name:"loginForm",className:"inner-container"},r.a.createElement("div",{className:"title-section"},r.a.createElement("h4",null,"Have an account?")),r.a.createElement("section",{className:"inputs-section"},r.a.createElement("div",null,i.errors.username.length>0&&r.a.createElement("span",null,i.errors.username),r.a.createElement("input",{name:"username",value:i.username,onChange:m,type:"text",placeholder:"username"})),r.a.createElement("div",null,i.errors.password.length>0&&r.a.createElement("span",null,i.errors.password),r.a.createElement("input",{name:"password",value:i.password,onChange:m,onKeyDown:d,type:"password",placeholder:"password"}))),r.a.createElement("section",{className:"btn-section"},r.a.createElement("button",{onClick:d,disabled:t,className:"btn"},"LOGIN"),"or",r.a.createElement("button",{onClick:function(e){y.c.info("Logging in as GuestUser...",{position:"top-right",autoClose:1e3,hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,transition:y.a}),a(Object(O.a)({},s))},disabled:t,className:"guest-btn"},"Login as Guest"))),r.a.createElement(y.b,{position:"top-right",autoClose:1e3,hideProgressBar:!0,newestOnTop:!1,closeOnClick:!1,rtl:!1,pauseOnFocusLoss:!1,draggable:!1,pauseOnHover:!1,transport:y.a}))}));var k=Object(s.b)((function(e){return{loading:e.user.loading}}))((function(e){var t=e.loading,a=Object(n.useState)({username:"",email:"",password:"",errors:{username:"",email:"",password:""}}),s=Object(o.a)(a,2),c=s[0],l=s[1],i=function(e){var t=e.target,a=t.name,n=t.value,r=c.errors;switch(a){case"username":r.username=n.length<5?"At least 5 characters!":"";break;case"password":r.password=n.length<6?"At least 6 characters!":"";break;case"email":r.email=N.test(n)?"":"Email is not valid!"}l(Object(O.a)(Object(O.a)({},c),{},Object(h.a)({errors:r},a,n)))},u=function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!C(c.errors)||"Enter"!==t.key&&void 0!==t.key){e.next=7;break}return y.c.info("Registering...",{position:"top-right",autoClose:1e3,hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,transition:y.a}),e.next=5,g.a.post("/auth/register",c);case 5:y.c.success("Registration success!",{position:"top-right",autoClose:1e3,hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,transition:y.a}),l({username:"",email:"",password:"",errors:{username:"",email:"",password:""}});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),y.c.error("User exists!",{position:"top-right",autoClose:1e3,hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,transition:y.a});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{name:"registerForm",className:"inner-container"},r.a.createElement("div",{className:"title-section"},r.a.createElement("h4",null,"Create an account")),r.a.createElement("section",{className:"inputs-section"},r.a.createElement("div",null,c.errors.username.length>0&&r.a.createElement("span",null,c.errors.username),r.a.createElement("input",{name:"username",value:c.username,onChange:i,type:"text",placeholder:"username"})),r.a.createElement("div",null,c.errors.email.length>0&&r.a.createElement("span",null,c.errors.email),r.a.createElement("input",{name:"email",value:c.email,onChange:i,type:"email",placeholder:"email"})),r.a.createElement("div",null,c.errors.password.length>0&&r.a.createElement("span",null,c.errors.password),r.a.createElement("input",{name:"password",value:c.password,onChange:i,onKeyDown:u,type:"password",placeholder:"password"}))),r.a.createElement("section",{className:"btn-section"},r.a.createElement("button",{onClick:u,disabled:t,className:"btn"},"REGISTER"))),r.a.createElement(y.b,{position:"top-right",autoClose:1e3,hideProgressBar:!0,newestOnTop:!1,closeOnClick:!1,rtl:!1,pauseOnFocusLoss:!1,draggable:!1,pauseOnHover:!1,transport:y.a}))}));var w=function(){return r.a.createElement("div",{className:"auth-page-container"},r.a.createElement(S,null),r.a.createElement(k,null))},T=a(28),j=a(91);var _=Object(s.b)((function(e){return{username:e.user.username,items:e.posts.items}}),{editPostAsync:j.c,deletePostAsync:j.b})((function(e){var t=e.username,a=e.items,s=e.editPostAsync,c=e.deletePostAsync,u=Object(l.g)(),m=Object(l.h)().id,d=Object(n.useState)(!1),p=Object(o.a)(d,2),E=p[0],g=p[1],f=a.find((function(e){return e._id===m})),v=Object(n.useState)({editTitle:"",editContent:"",editImgLink:""}),b=Object(o.a)(v,2),y=b[0],N=b[1],C=function(e){return N(Object(O.a)(Object(O.a)({},y),{},Object(h.a)({},e.target.name,e.target.value)))};return r.a.createElement("div",{className:"post-page-container"},r.a.createElement("div",{onClick:function(){return u.goBack()},className:"icon"},r.a.createElement("i",{className:"fas fa-arrow-left"})),E?r.a.createElement("input",{className:"edit-input",value:y.newTitle,onChange:C,placeholder:f.title,name:"editTitle"}):r.a.createElement("h4",null,f.title),t===f.author&&r.a.createElement("div",{className:"edit-delete-btns"},r.a.createElement("div",{onClick:function(){return g(!0)},className:"icon"},r.a.createElement("i",{className:"fas fa-pen"})),r.a.createElement(i.b,{to:"/"},r.a.createElement("div",{onClick:function(){c(f._id)},className:"icon"},r.a.createElement("i",{className:"fas fa-trash"})))),r.a.createElement("span",{className:"author"},f.author),r.a.createElement("span",{className:"date"},f.date),E?r.a.createElement("textarea",{cols:"20",rows:"5",className:"edit-input",value:y.newContent,onChange:C,placeholder:f.content,name:"editContent"}):r.a.createElement("p",null,f.content),E?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(){var e,t;N(Object(O.a)(Object(O.a)({},y),{},{editImgLink:"https://picsum.photos/id/".concat((e=1,t=200,e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e),"/500/600")}))},disabled:!E},"Pick random image"),r.a.createElement("img",{width:"400",src:y.editImgLink,alt:"",style:{margin:"15px 0 20px"}})):r.a.createElement("img",{src:f.imglink,alt:""}),r.a.createElement("div",{className:"modal-btns"},r.a.createElement(i.b,{to:"/"},r.a.createElement("button",{className:"btn-post",onClick:function(){g(!1),N({editTitle:f.title,editContent:f.content,editImgLink:f.imglink})}},"Cancel")),r.a.createElement("button",{className:"btn-post",onClick:function(){var e=Object(O.a)(Object(O.a)({},f),{},{title:y.editTitle,content:y.editContent,imglink:y.editImgLink,date:(new Date).toLocaleString()});s(e),g(!1),N({editTitle:"",editContent:"",editImgLink:""})}},"SAVE")))})),U=r.a.lazy((function(){return Promise.all([a.e(4),a.e(7)]).then(a.bind(null,162))}));t.default=Object(s.b)((function(e){var t=e.user;return{isLoggedIn:t.isLoggedIn,validUntil:t.validUntil,username:t.username}}),{logoutUser:c.b})((function(e){var t=e.username,a=e.isLoggedIn,s=e.validUntil,c=e.logoutUser;return Object(n.useEffect)((function(){if(a){var e=(new Date).getTime()/1e3;s<=e&&(c(),f.a.emit("user_disconnected",t))}else f.a.emit("user_disconnected",t)}),[a,c,s,t]),r.a.createElement(l.d,null,r.a.createElement(l.b,{exact:!0,path:"/"},a?r.a.createElement(n.Suspense,{fallback:r.a.createElement(T.a,null)},r.a.createElement(U,null)):r.a.createElement(l.a,{to:"/login"})),r.a.createElement(l.b,{path:"/login"},a?r.a.createElement(l.a,{to:"/"}):r.a.createElement(w,null)),r.a.createElement(l.b,{path:"/profile"},a?r.a.createElement(b,null):r.a.createElement(l.a,{to:"/login"})),r.a.createElement(l.b,{path:"/:id"},a?r.a.createElement(_,null):r.a.createElement(l.a,{to:"/login"})),r.a.createElement(l.b,{path:"*",component:function(){return r.a.createElement("h2",null,"404 Page Not Found")}}))}))},53:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return i}));var n=a(27),r=a(10),s=a(54),c=a.n(s),l=function(e){return function(t){t({type:r.a.LOGIN_START}),c.a.post("auth/login",{username:e.username,password:e.password}).then((function(e){return t(function(e){return{type:r.a.LOGIN_SUCCESS,payload:e}}(e.data))})).catch((function(e){return t((a=e.message,{type:r.a.LOGIN_FAILURE,payload:a}));var a}))}},o=function(e){return function(t){t({type:r.a.UPDATE_PROFILE_START}),c.a.post("profile/".concat(e.key),Object(n.a)({},e.key,e.value)).then((function(e){return t(function(e){return{type:r.a.UPDATE_PROFILE_SUCCESS,payload:e}}(e.data))})).catch((function(e){return t((a=e.message,{type:r.a.UPDATE_PROFILE_FAILURE,payload:a}));var a}))}},i=function(){return{type:r.a.LOGOUT}}},55:function(e,t,a){"use strict";var n=a(115),r=a.n(n).a.connect("/",{"sync disconnect on unload":!1});t.a=r},91:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return i}));var n=a(7),r=a(54),s=a.n(r),c=function(e){return function(t){t({type:n.a.NEW_POST_START}),s.a.post("/post",e).then((function(e){t(function(e){return{type:n.a.NEW_POST_SUCCESS,payload:e}}(e.data.post))})).catch((function(e){return t((a=e.message,{type:n.a.NEW_POST_FAILURE,payload:a}));var a}))}},l=function(){return function(e){e({type:n.a.FETCH_POSTS_START}),s.a.get("/post").then((function(t){return e((a=t.data.posts.reverse(),{type:n.a.FETCH_POSTS_SUCCESS,payload:a}));var a})).catch((function(t){return e((a=t.message,{type:n.a.FETCH_POSTS_FAILURE,payload:a}));var a}))}},o=function(e){return function(t){t({type:n.a.EDIT_POST_START}),s.a.post("/post/".concat(e._id),e).then((function(e){return t(function(e){return{type:n.a.EDIT_POST_SUCCESS,payload:e}}(e.data.post))})).catch((function(e){return t((a=e.message,{type:n.a.EDIT_POST_FAILURE,payload:a}));var a}))}},i=function(e){return function(t){t({type:n.a.DELETE_POST_START}),s.a.delete("/post/".concat(e)).then((function(){return t(function(e){return{type:n.a.DELETE_POST_SUCCESS,payload:e}}(e))})).catch((function(e){return t((a=e.message,{type:n.a.DELETE_POST_FAILURE,payload:a}));var a}))}}},96:function(e,t,a){}}]);
//# sourceMappingURL=5.ce359692.chunk.js.map