(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[7],{162:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),l=a(52),r=a(25),s=a(20),o=a(55);var i=Object(r.b)((function(e){var t=e.user.username,a=e.chat;return{usersOnline:a.usersOnline,chatHistory:a.chatHistory,username:t}}),{newMessage:function(e){return{type:s.a.NEW_MESSAGE,payload:e}},userOnline:function(e){return{type:s.a.USER_ONLINE,payload:e}}})((function(e){var t=e.usersOnline,a=e.chatHistory,r=e.username,s=e.newMessage,i=e.userOnline,u=c.a.useState(""),m=Object(l.a)(u,2),f=m[0],E=m[1],p=c.a.useRef();return Object(n.useEffect)((function(){return o.a.on("update_users_online",(function(e){i(e)})),o.a.on("update_chat_history",(function(e){s(e)})),function(){o.a.off("update_users_online"),o.a.off("update_chat_history")}}),[i,s]),Object(n.useEffect)((function(){r&&o.a.emit("new_online_user",r)}),[r]),Object(n.useEffect)((function(){p.current.scrollTo(0,99999)}),[a]),c.a.createElement("section",{class:"chat-section"},c.a.createElement("div",{className:"chat-header"},c.a.createElement("h4",null,"Live global chat"),c.a.createElement("p",null,"Online: ",c.a.createElement("span",null,t.length))),c.a.createElement("div",{ref:p,class:"chat-history"},a.map((function(e,t){return c.a.createElement("div",{key:t,className:"message ".concat(e.username===r?"my":"")},c.a.createElement("p",{style:{fontSize:"0.8rem",color:"#6e93d6"}},"".concat(e.username)),c.a.createElement("p",null,"".concat(e.text)),c.a.createElement("span",null,(new Date).toLocaleString))}))),c.a.createElement("div",{class:"send-message"},c.a.createElement("input",{type:"text",placeholder:"Type your message",value:f,onChange:function(e){return E(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&(""!==f&&o.a.emit("new_message",{username:r,text:f}),E(""))}}),c.a.createElement("i",{onClick:function(){""!==f&&o.a.emit("new_message",{username:r,text:f}),E("")},class:"fas fa-paper-plane"})),c.a.createElement("div",{className:"users-online"},t.map((function(e,t){return c.a.createElement("span",null,e)}))))})),u=a(59),m=a.n(u),f=a(60),E=a(27),p=a(1),h=a(149),d=a.n(h),b=a(91),g=a(28),v=c.a.lazy((function(){return a.e(6).then(a.bind(null,163))}));d.a.setAppElement("#root");var y={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{backgroundColor:"transparent"}};var O=Object(r.b)((function(e){var t=e.posts,a=t.items,n=t.areFetching;return{items:a,username:e.user.username,areFetching:n}}),{fetchPostsAsync:b.d,createPostAsync:b.a})((function(e){var t=e.username,a=e.createPostAsync,r=e.fetchPostsAsync,s=e.items,o=Object(n.useState)(""),i=Object(l.a)(o,2),u=i[0],h=i[1],b=Object(n.useState)(!1),O=Object(l.a)(b,2),k=O[0],j=O[1],w=Object(n.useState)({title:"",content:"",imglink:""}),N=Object(l.a)(w,2),C=N[0],_=N[1],S=Object(n.useState)(!1),x=Object(l.a)(S,2),M=x[0],A=x[1];function L(){_({title:"",content:"",imglink:""}),j(!1)}var P=function(e){return _(Object(p.a)(Object(p.a)({},C),{},Object(E.a)({},e.target.name,e.target.value)))},T=function(){var e=Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{A(!0),_(Object(p.a)(Object(p.a)({},C),{},{imglink:"https://picsum.photos/id/".concat((t=1,a=200,t=Math.ceil(t),a=Math.floor(a),Math.floor(Math.random()*(a-t+1))+t),"/500/600")})),A(!1)}catch(n){console.log(n.message)}case 1:case"end":return e.stop()}var t,a}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){t&&r()}),[t,r]);var F=s.filter((function(e){return e.title.toLowerCase().includes(u.toLowerCase())}));return c.a.createElement("section",{className:"posts-section"},c.a.createElement("div",{className:"menu"},c.a.createElement("div",{className:"new-post"},c.a.createElement("button",{onClick:function(){j(!0)}},"NEW POST")),c.a.createElement("div",{className:"search-post"},c.a.createElement("input",{value:u,onChange:function(e){return h(e.target.value)},type:"text",placeholder:"Search posts by title"}))),c.a.createElement(n.Suspense,{fallback:c.a.createElement(g.a,null)},c.a.createElement(v,{filteredPosts:F})),c.a.createElement(d.a,{isOpen:k,onRequestClose:L,contentLabel:"modal",style:y},c.a.createElement("div",{id:"modal"},c.a.createElement("label",{htmlFor:"new-title"},"Title"),c.a.createElement("input",{value:C.title,onChange:P,name:"title",placeholder:"Title of your post",id:"new-title",type:"text"}),c.a.createElement("label",{htmlFor:"new-title"},"Main body"),c.a.createElement("textarea",{value:C.content,onChange:P,name:"content",placeholder:"Content of your post",id:"post-content",cols:"20",rows:"4"}),c.a.createElement("button",{onClick:T},"Pick random image"),M?c.a.createElement(g.a,null):C.imglink?c.a.createElement("img",{width:"300",className:"imglink",src:C.imglink,alt:""}):null,c.a.createElement("div",{class:"modal-btns",style:{marginTop:15}},c.a.createElement("button",{onClick:L},"Cancel"),c.a.createElement("button",{onClick:function(){var e={author:t,title:C.title,content:C.content,imglink:C.imglink,date:(new Date).toLocaleString()};a(e),_({title:"",content:"",imglink:""}),j(!1)}},"SAVE")))))})),k=a(26),j=a(53);var w=Object(r.b)((function(e){return{username:e.user.username}}),{logoutUser:j.b})((function(e){var t=e.username,a=e.logoutUser;return c.a.createElement("nav",null,c.a.createElement("div",{className:"left-nav"},c.a.createElement(k.b,{to:"/profile"},c.a.createElement("div",{className:"icon"},c.a.createElement("i",{className:"fas fa-user-circle"}))),c.a.createElement("h4",null,"Welcome, ",t,"!")),c.a.createElement("div",{className:"right-nav"},c.a.createElement("a",{target:"_blank",href:"https://github.com/frixaco/post-n-chat",rel:"noopener noreferrer"},c.a.createElement("div",{className:"icon"},c.a.createElement("i",{className:"fab fa-github"}))),c.a.createElement("div",{onClick:function(){o.a.emit("user_disconnected",t),a()},className:"icon"},c.a.createElement("i",{className:"fas fa-sign-out-alt"}))))}));t.default=function(){return c.a.createElement("div",{class:"home-page-container"},c.a.createElement(w,null),c.a.createElement("main",null,c.a.createElement(O,null),c.a.createElement(i,null)))}}}]);
//# sourceMappingURL=7.93c6af8f.chunk.js.map